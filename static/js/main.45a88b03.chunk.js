(this.webpackJsonpkaraoke=this.webpackJsonpkaraoke||[]).push([[0],{61:function(e,t,n){e.exports=n(93)},92:function(e,t,n){},93:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(49),c=n.n(a),i=n(5),u=n.n(i),l=(n(66),n(68),n(14)),s={},d=new URLSearchParams(window.location.search);[{localStorageKey:"firebaseApiKey",envKey:"REACT_APP_FIREBASE_API_KEY",queryParamKey:"a"},{localStorageKey:"firebaseProjectId",envKey:"REACT_APP_FIREBASE_PROJECT_ID",queryParamKey:"b"},{localStorageKey:"youtubeApiKey",envKey:"REACT_APP_YOUTUBE_API_KEY",queryParamKey:"c"}].forEach((function(e){var t=e.localStorageKey,n=e.queryParamKey,r=d.get(n);r&&localStorage.setItem(t,r),s[t]=e}));var f=function(e){var t=s[e];if(!t)throw new Error('"'.concat(e,'" is not defined in the SECRETS_CONFIG.'));var n=t.envKey,r=t.queryParamKey,o=localStorage.getItem(e),a=Object({NODE_ENV:"production",PUBLIC_URL:"/traplovers-karaoke",REACT_APP_FIREBASE_API_KEY:"AIzaSyB8cesB1wR8ch_g-TuOSI_BH4-aIJvRr_w",REACT_APP_FIREBASE_PROJECT_ID:"karaoke-11825",REACT_APP_YOUTUBE_API_KEY:"AIzaSyDDBXfZ0K-YZPLe24r0QpESX3cMiiL6lQM"})[n];if(o)return o;if(a)return a;throw new Error('"'.concat(e,'" must be defined in localStorage, "').concat(r,'" must be defined in the query string, or "').concat(n,'" must be defined as an environment variable.'))},b=n(11),p=n(25),m=n(15),g=n(3),O=n(6);function j(){var e=Object(O.a)(["\n  font-weight: 600;\n  font-size: 20px;\n  display: block;\n  line-height: 1.3;\n  margin: 0;\n"]);return j=function(){return e},e}function y(){var e=Object(O.a)(["\n  padding: 15px;\n  display: flex;\n  justify-content: space-between;\n  align-items: baseline;\n"]);return y=function(){return e},e}var h=Object(g.b)(y()),v=Object(g.b)(j()),E=function(e){var t=e.text,n=e.children;return Object(g.c)("div",{css:h},Object(g.c)("h2",{css:v},t),n)},x={appTitle:"Untitled Karaoke App",cancel:"Cancel",next:"Next",songsEmptySet:"Your playlist is empty.",roomAddSong:"Add Song",roomAddFavorite:"Add favorite",roomTvView:"TV mode",songSearch:"Search Videos",createRoomTitle:"Create Room",addSongTitle:"Add Song to Queue",searchLabel:"Search YouTube videos",searchButton:"Search",joinRoomTitle:function(e){return"Join ".concat(e)},joinRoomName:"Name",joinRoomPassword:"Password",joinRoomButton:"Join",animalName:function(e){return"Anonymous ".concat(e)},favoritesTitle:"Favorites",favoritesEmpty:"You don't have any favorite videos.",addRoomLink:"Create Room",favoritesLink:"Favorites",searchLink:"Search",play:"Play Song",pause:"Pause Song",nextSong:"Next Song",exitRoom:"Exit Room"},S=function(e,t){var n=null;if(t){if("function"!==typeof x[e])throw new Error('The string "'.concat(e,'" must be a function when called with a second argument.'));n=x[e](t)}else n=x[e];if(n)return n;throw new Error('The string "'.concat(e,'" could not be found.'))};function w(){var e=Object(O.a)(["\n  ","\n  color: ",";\n"]);return w=function(){return e},e}function P(){var e=Object(O.a)(["\n  color: ",";\n  font-size: 18px;\n  font-weight: bold;\n  text-decoration: none;\n  margin-left: 15px;\n  text-align: right;\n  white-space: nowrap;\n\n  &:hover {\n    text-decoration: underline;\n  }\n"]);return P=function(){return e},e}function k(){var e=Object(O.a)(["\n  position: relative;\n\n  & + & {\n    padding-top: ",";\n\n    &:before {\n      content: '';\n      display: block;\n      position: absolute;\n      left: ",";\n      top: 0;\n      right: 0;\n      border-top: ",";\n    }\n  }\n"]);return k=function(){return e},e}function A(){var e=Object(O.a)(["\n  border: none;\n  cursor: pointer;\n\n  &:hover {\n    background: ",";\n  }\n"]);return A=function(){return e},e}var R="1px solid #333",I=Object(g.b)(A(),"#333"),C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1px";return Object(g.b)(k(),t,e,R)},L=Object(g.b)(P(),"#3af"),D=Object(g.b)(w(),L,"#999"),_=Object(l.c)((function(e){var t=e.firestore,n=Object(r.useState)(""),o=Object(m.a)(n,2),a=o[0],c=o[1],i=Object(r.useState)(""),u=Object(m.a)(i,2),l=u[0],s=u[1],d=Object(p.g)(),f=function(e){d.push("/room/".concat(e))},O=function(e){var n=e.roomId,r=e.roomName;return t.collection("publicRoomListings").add({roomId:n,roomName:r,sortKey:r.toLowerCase()}).then((function(){return n})).catch((function(e){throw new Error("Error writing document: ".concat(r),e)}))};return Object(g.c)(r.Fragment,null,Object(g.c)(E,{text:S("createRoomTitle")},Object(g.c)(b.b,{css:D,to:"/"},S("cancel"))),Object(g.c)("form",{onSubmit:function(e){var n;e.preventDefault(),(n={name:a.trim(),password:l},t.collection("rooms").add(n).then((function(e){return{roomId:e.id,roomName:n.name}})).catch((function(e){throw new Error("Error writing document: ".concat(a),e)}))).then(O).then(f)}},Object(g.c)("label",null,"Name:",Object(g.c)("input",{onChange:function(e){return c(e.target.value)},type:"text",value:a})),Object(g.c)("label",null,"Password:",Object(g.c)("input",{onChange:function(e){return s(e.target.value)},type:"text",value:l})),Object(g.c)("button",null,"Submit")))})),N=function(){return o.a.createElement(E,{text:"TODO: Edit Room"})},T=function(e){return function(t){e(t.target.value)}},Y=function(){return o.a.createElement("p",null,"Loading...")},B=["Aardvark","Alpaca","Anteater","Antelope","Armadillo","Baboon","Bat","Bear","Beaver","Beetle","Bison","Bobcat","Buffalo","Butterfly","Camel","Capybara","Caribou","Cat","Cheetah","Chicken","Chimpanzee","Chipmunk","Coyote","Cow","Crab","Crow","Cuttlefish","Deer","Dingo","Dog","Donkey","Dolphin","Duck","Echidna","Elephant","Elk","Ferret","Flamingo","Fox","Gecko","Gibbon","Giraffe","Goat","Goose","Gorilla","Groundhog","Hare","Hedgehog","Hippo","Horse","Hyena","Ibex","Impala","Jaguar","Kangaroo","Koala","Ladybug","Lemming","Lemur","Leopard","Lion","Lizard","Llama","Lynx","Mallard","Manatee","Mandrill","Meerkat","Mongoose","Monkey","Moose","Narwhal","Ocelot","Opossum","Orangutan","Oryx","Otter","Owl","Ox","Panda","Pangolin","Penguin","Pidgeon","Pig","Platypus","Porcupine","Porpoise","Prairie Dog","Rabbit","Raccoon","Rhino","Seal","Seagull","Sheep","Skunk","Sloth","Snail","Squid","Squirrel","Tamarin","Tapir","Tiger","Tortoise","Turkey","Turtle","Wallaby","Walrus","Warthog","Weasel","Wildebeest","Wolf","Wolverine","Wombat","Woodchuck","Yak","Zebra"],K=Object(r.createContext)({getRoomAuth:function(){return{name:localStorage.getItem("singerName"),id:localStorage.getItem("roomID"),password:localStorage.getItem("roomPassword")}},setRoomAuth:function(e,t,n){localStorage.setItem("singerName",e.trim()||function(){var e=B[Math.floor(Math.random()*B.length)];return S("animalName",e)}()),localStorage.setItem("roomID",t),localStorage.setItem("roomPassword",n)}}),F=function(){var e=Object(r.useContext)(K),t=e.getRoomAuth,n=e.setRoomAuth,a=Object(r.useState)(t().name||""),c=Object(m.a)(a,2),i=c[0],u=c[1],s=Object(r.useState)(""),d=Object(m.a)(s,2),f=d[0],b=d[1],g=Object(p.h)().id,O=Object(p.g)(),j=Object(r.useRef)(null),y=Object(r.useRef)(null),h=function(e){e.preventDefault(),n(i,g,f),O.push("/room/".concat(g))};return Object(r.useEffect)((function(){var e=j.current,t=y.current;e&&t&&(i?e.focus():t.focus())}),[j,y]),o.a.createElement(l.a,{filter:["roomId","==",g],path:"publicRoomListings",render:function(e){var t=e.isLoading,n=e.data;if(t)return o.a.createElement(Y,null);var r=n[0].roomName;return o.a.createElement(o.a.Fragment,null,o.a.createElement(E,{text:S("joinRoomTitle",r)}),o.a.createElement("form",{onSubmit:h},o.a.createElement("label",null,o.a.createElement("span",null,S("joinRoomName")),o.a.createElement("input",{onChange:T(u),ref:j,type:"text",value:i})),o.a.createElement("label",null,o.a.createElement("span",null,S("joinRoomPassword")),o.a.createElement("input",{onChange:T(b),ref:y,type:"text",value:f})),o.a.createElement("button",null,S("joinRoomButton"))))}})};function G(){var e=Object(O.a)(["\n  list-style-type: none;\n  border-top: ",";\n  border-bottom: ",";\n  margin: 0;\n  padding: 0;\n  max-width: 100vw;\n  overflow: hidden;\n"]);return G=function(){return e},e}var U=n(60).a.ul(G(),R,R);function V(){var e=Object(O.a)(["\n  ","\n  padding: 15px 15px;\n  display: block;\n  color: #fff;\n  text-decoration: none;\n"]);return V=function(){return e},e}var z=C("15px"),q=Object(g.b)(V(),I),W=function(e){var t=e.id,n=e.roomName,r=e.roomId;return Object(g.c)("li",{css:z,key:t},Object(g.c)(b.b,{css:q,to:"/room/".concat(r)},n))},M=function(){return Object(g.c)(r.Fragment,null,Object(g.c)(E,{text:"Rooms"},Object(g.c)(b.b,{css:L,to:"/room/new"},S("addRoomLink"))),Object(g.c)(l.a,{path:"publicRoomListings",render:function(e){var t=e.isLoading,n=e.data;return t?Object(g.c)(Y,null):Object(g.c)(U,null,n.map(W))},sort:"sortKey"}))},J=function(e){return function(t){var n=Object(r.useContext)(K).getRoomAuth,a=Object(p.h)().id,c=n(),i=c.id,s=c.password,d=o.a.createElement(p.a,{to:"/room/".concat(a,"/join")});return a!==i?d:o.a.createElement(l.a,{filter:[[u.a.firestore.FieldPath.documentId(),"==",i],["password","==",s]],path:"rooms",render:function(n){var r=n.isLoading,a=n.data;return r?o.a.createElement(Y,null):a.length?o.a.createElement(e,Object.assign({room:a[0]},t)):d}})}},H=function(e){var t=e.children;return o.a.createElement("span",{dangerouslySetInnerHTML:{__html:t}})},X=n(26),Q="favoriteSongs",Z=JSON.parse(localStorage.getItem(Q))||{},$=function(e){return localStorage.setItem(Q,JSON.stringify(e))},ee=Object(r.createContext)({addSong:function(e,t){Z[e]=t,$(Z)},removeSong:function(e){delete Z[e],$(Z)},hasSong:function(e){return!!Z[e]},mapSongs:function(e){return Object.keys(Z).map((function(t,n){return e(t,Z[t],n)}))},songCount:function(){return Object.keys(Z).length}});function te(){var e=Object(O.a)(["\n  ","\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 3px;\n  border-radius: 6px;\n  background: transparent;\n  color: #fff;\n  font-size: 24px;\n  line-height: 1;\n"]);return te=function(){return e},e}function ne(){var e=Object(O.a)(["\n  padding: 7px 12px;\n  display: flex;\n  align-items: center;\n"]);return ne=function(){return e},e}var re=Object(g.b)(ne()),oe=Object(g.b)(te(),I),ae=function(e){var t=e.ytId,n=e.title,o=Object(r.useContext)(ee),a=o.addSong,c=o.removeSong,i=o.hasSong,u=Object(r.useState)(i(t)),l=Object(m.a)(u,2),s=l[0],d=l[1];return Object(g.c)("div",{css:re},Object(g.c)("button",{css:oe,onClick:function(){s?c(t):a(t,n),d(!s)}},s?Object(g.c)(X.b,{color:"#ff4dc7"}):Object(g.c)(X.c,{color:"#aaa"})))};function ce(){var e=Object(O.a)(["\n  object-fit: cover;\n  flex-shrink: 0;\n  outline: ",";\n"]);return ce=function(){return e},e}var ie=Object(g.b)(ce(),R),ue=function(e){var t=e.ytId,n=e.width,r="https://i.ytimg.com/vi/".concat(t,"/hqdefault.jpg");return Object(g.c)("img",{alt:"","aria-hidden":"true",css:ie,height:n*(9/16),src:r,width:n})};ue.defaultProps={width:100};var le=ue;function se(){var e=Object(O.a)(["\n  flex: 1 0;\n  color: #fff;\n  font-size: 13px;\n  padding: 0 0 0 15px;\n  line-height: 1.5;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden;\n"]);return se=function(){return e},e}function de(){var e=Object(O.a)(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  display: block;\n  padding: 10px 10px 7px 15px;\n  border-bottom-right-radius: 5px;\n  font-size: 14px;\n  font-weight: bold;\n  background: #000;\n  line-height: 1;\n  color: #bbb;\n"]);return de=function(){return e},e}function fe(){var e=Object(O.a)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 10px 0 10px 15px;\n  box-sizing: border-box;\n  max-width: 100vw;\n  overflow: hidden;\n  ","\n"]);return fe=function(){return e},e}var be=Object(g.b)(fe(),C("130px","11px")),pe=Object(g.b)(de()),me=Object(g.b)(se()),ge=function(e){var t=e.singer,n=e.title,r=e.ytId,o=e.index;return Object(g.c)("li",{css:be},Object(g.c)("span",{css:pe},0===o?S("next"):o+1),Object(g.c)(le,{ytId:r}),Object(g.c)("span",{css:me},Object(g.c)(H,null,n),Object(g.c)("br",null),Object(g.c)("strong",null,t)),Object(g.c)(ae,{title:n,ytId:r}))},Oe=J((function(e){var t=e.roomId;return o.a.createElement(l.a,{path:"rooms/".concat(t,"/songs"),render:function(e){var t=e.isLoading,n=e.data;return t?o.a.createElement(Y,null):n.length?o.a.createElement(U,null,n.map((function(e,t){return o.a.createElement(ge,Object.assign({},e,{index:t,key:e.id}))}))):o.a.createElement("p",null,S("songsEmptySet"))},sort:"created"})}));function je(){var e=Object(O.a)(["\n  background: #222;\n  display: block;\n  padding: 10px;\n  margin: 0;\n  font-size: 40px;\n  height: 60px;\n  width: 60px;\n  line-height: 40px;\n  border-radius: 30px;\n  ","\n\n  & + & {\n    margin-left: 20px;\n  }\n"]);return je=function(){return e},e}function ye(){var e=Object(O.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin: 50px 20px;\n"]);return ye=function(){return e},e}var he=Object(g.b)(ye()),ve=Object(g.b)(je(),I),Ee=Object(l.c)((function(e){var t=e.firestore,n=e.roomId,r=function(e){return function(r){r.preventDefault();var o=t.collection("rooms/".concat(n,"/commands"));o.get().then((function(t){t.docs.map((function(e){var t=e.id;return o.doc(t).delete()})),o.add({key:e,created:Date.now()})}))}};return Object(g.c)("div",{css:he},Object(g.c)("button",{css:ve,onClick:r("PLAY"),title:S("play"),type:"button"},Object(g.c)("span",{"aria-hidden":"true"},Object(g.c)(X.e,{color:"#fff"}))),Object(g.c)("button",{css:ve,onClick:r("PAUSE"),title:S("pause"),type:"button"},Object(g.c)("span",{"aria-hidden":"true"},Object(g.c)(X.d,{color:"#fff"}))),Object(g.c)("button",{css:ve,onClick:r("NEXT_SONG"),title:S("nextSong"),type:"button"},Object(g.c)("span",{"aria-hidden":"true"},Object(g.c)(X.a,{color:"#fff"}))))})),xe=J((function(e){var t=e.room,n=t.id,o=t.name;return Object(g.c)(r.Fragment,null,Object(g.c)(E,{text:o},Object(g.c)(b.b,{css:L,to:"/room/".concat(n,"/song/search")},S("roomAddSong"))),Object(g.c)(Oe,{roomId:n}),Object(g.c)(Ee,{roomId:n}),Object(g.c)("p",null,Object(g.c)(b.b,{to:"/room/".concat(n,"/play")},S("roomTvView"))))})),Se=n(54);function we(){var e=Object(O.a)(["\n  color: #fff;\n  font-size: 13px;\n  padding: 0 15px;\n  line-height: 1.5;\n"]);return we=function(){return e},e}function Pe(){var e=Object(O.a)(["\n  ","\n  background: transparent;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  text-align: left;\n  padding: 10px 0 10px 15px;\n  flex: 1 0;\n"]);return Pe=function(){return e},e}function ke(){var e=Object(O.a)(["\n  display: flex;\n  flex-direction: row;\n  ","\n"]);return ke=function(){return e},e}var Ae=Object(g.b)(ke(),C("130px")),Re=Object(g.b)(Pe(),I),Ie=Object(g.b)(we()),Ce=Object(l.c)((function(e){var t=e.firestore,n=e.ytId,o=e.title,a=Object(r.useContext)(K).getRoomAuth,c=Object(p.h)().id,i=Object(p.g)();return Object(g.c)("li",{css:Ae},Object(g.c)("button",{css:Re,onClick:function(e){e.preventDefault(),t.collection("rooms/".concat(c,"/songs")).add({singer:a().name,ytId:n,created:Date.now(),title:o}),i.push("/room/".concat(c))}},Object(g.c)(le,{ytId:n}),Object(g.c)("span",{css:Ie},Object(g.c)(H,null,o))),Object(g.c)(ae,{title:o,ytId:n}))})),Le=function(e){var t=e.trim();if(t){var n=encodeURI("karaoke ".concat(t)),r=f("youtubeApiKey");return{url:"https://www.googleapis.com/youtube/v3/search?q=".concat(n,"&key=").concat(r,"&type=video&part=snippet&videoEmbeddable=true&maxResults=50"),headers:{Accept:"application/json"}}}return{value:{items:[]}}},De=Object(Se.connect)((function(e){var t=e.query;return{resultsFetch:Le(t)}}))((function(e){var t=e.resultsFetch;if(t){var n=t.pending,r=t.rejected,a=t.fulfilled,c=t.value;if(n)return o.a.createElement(Y,null);if(r)return o.a.createElement("p",null,"oh noes");if(a&&c.items&&c.items.length)return o.a.createElement(U,null,c.items.map((function(e){var t=e.id.videoId,n=e.snippet.title;return o.a.createElement(Ce,{key:t,title:n,ytId:t})})))}return null})),_e=function(){var e=Object(r.useRef)(null),t=Object(r.useState)(""),n=Object(m.a)(t,2),a=n[0],c=n[1],i=Object(r.useState)(a),u=Object(m.a)(i,2),l=u[0],s=u[1];return Object(r.useEffect)((function(){var t=e.current;t&&t.focus()}),[e]),o.a.createElement(o.a.Fragment,null,o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),s(a)}},o.a.createElement("label",null,o.a.createElement("span",null,S("searchLabel")),o.a.createElement("input",{onChange:function(e){c(e.target.value)},ref:e,type:"search",value:a})),o.a.createElement("button",null,S("searchButton"))),o.a.createElement(De,{query:l}))},Ne=function(){var e=Object(r.useContext)(ee),t=e.songCount,n=e.mapSongs;return o.a.createElement(o.a.Fragment,null,t()?o.a.createElement(U,null,n((function(e,t){return o.a.createElement(Ce,{key:e,title:t,ytId:e})}))):o.a.createElement("p",null,S("favoritesEmpty")))};function Te(){var e=Object(O.a)(["\n  ","\n  background: ",";\n"]);return Te=function(){return e},e}function Ye(){var e=Object(O.a)(["\n  ","\n  ","\n"]);return Ye=function(){return e},e}function Be(){var e=Object(O.a)(["\n  text-decoration: none;\n  display: block;\n  text-align: center;\n  font-weight: 600;\n  padding: 7px;\n  color: #fff;\n"]);return Be=function(){return e},e}function Ke(){var e=Object(O.a)(["\n  display: block;\n  flex: 1 0;\n\n  & + & {\n    border-left: 1px solid ",";\n  }\n"]);return Ke=function(){return e},e}function Fe(){var e=Object(O.a)(["\n  display: flex;\n  margin: 0;\n  padding: 0;\n  display: flex;\n  list-style-type: none;\n  margin: 0 15px 20px 15px;\n  border: 1px solid ",";\n  border-radius: 6px;\n  overflow: hidden;\n"]);return Fe=function(){return e},e}var Ge=Object(g.b)(Fe(),"#07c"),Ue=Object(g.b)(Ke(),"#07c"),Ve=Object(g.b)(Be()),ze=Object(g.b)(Ye(),Ve,I),qe=Object(g.b)(Te(),Ve,"#07c"),We=function(e){var t=e.path,n=e.label;return Object(p.i)({path:t,exact:!0})?Object(g.c)("span",{css:qe},n):Object(g.c)(b.b,{css:ze,to:t},n)},Me=function(e){var t=e.routes;return Object(g.c)("ul",{css:Ge},t.map((function(e){return Object(g.c)("li",{css:Ue,key:e.path},Object(g.c)(We,e))})))},Je=[{Component:_e,path:"/room/:id/song/search"},{Component:Ne,path:"/room/:id/song/faves"}],He=J((function(e){var t=e.room.id;return Object(g.c)(r.Fragment,null,Object(g.c)(E,{text:S("addSongTitle")},Object(g.c)(b.b,{css:D,to:"/room/".concat(t)},S("cancel"))),Object(g.c)(Me,{routes:[{path:"/room/".concat(t,"/song/search"),label:S("searchLink")},{path:"/room/".concat(t,"/song/faves"),label:S("favoritesLink")}]}),Object(g.c)(p.d,null,Je.map((function(e){var t=e.Component,n=e.path;return Object(g.c)(p.b,{exact:!0,key:n,path:n},Object(g.c)(t,null))}))))})),Xe=n(58),Qe=n(55),Ze=function(e){var t=e.bounceDuration,n=e.children,o=e.sleepDuration,a=Object(r.useState)(!1),c=Object(m.a)(a,2),i=c[0],u=c[1],l=Object(r.useState)(null),s=Object(m.a)(l,2),d=s[0],f=s[1],b=Object(r.useState)(!1),p=Object(m.a)(b,2),g=p[0],O=p[1],j=Object(r.useCallback)((function(){g||(O(!0),setTimeout((function(){return O(!1)}),o),u(!0),clearTimeout(d),f(setTimeout((function(){return u(!1)}),t)))}),[o,g,d,t]);return Object(r.useEffect)((function(){return window.addEventListener("mousemove",j),function(){return window.removeEventListener("mousemove",j)}}),[j]),n(i)};Ze.defaultProps={bounceDuration:1e3,sleepDuration:200};var $e=Ze,et=function(e){var t=e.percent,n=e.radius,r=e.strokeWidth,a=e.secondaryColor,c=e.primaryColor,i=2*n,u=i*Math.PI;return o.a.createElement("div",{style:{width:i,height:i,transform:"rotate(-90deg)"}},o.a.createElement("svg",{height:i,viewBox:"0 0 ".concat(i," ").concat(i),width:i,xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("circle",{cx:n,cy:n,fill:"none",r:n-r/2,stroke:a,strokeWidth:r}),o.a.createElement("circle",{cx:n,cy:n,fill:"none",r:n-r/2,stroke:c,strokeDasharray:u,strokeWidth:r,style:{strokeDashoffset:u-u*Math.min(1,t),transition:"stroke-dashoffset 0.3s"}})))};et.defaultProps={radius:50,strokeWidth:4,secondaryColor:"#444",primaryColor:"#fff"};var tt=et,nt=n(4),rt=n(36),ot=Object(rt.a)({id:"segue",initial:"playing",context:{limit:1e4,elapsed:0,stepDate:null},states:{playing:{entry:["setStepDate","updateProgress"],exit:"incrementElapsed",after:{200:{target:"playing"}},on:{"":{target:"done",cond:"limitExceeded"},PAUSE:{target:"paused"}}},paused:{on:{PLAY:{target:"playing"}}},done:{type:"final"}}},{actions:{setStepDate:Object(nt.b)({stepDate:function(){return Date.now()}}),incrementElapsed:Object(nt.b)({elapsed:function(e){var t=e.stepDate;return e.elapsed+(Date.now()-t)}}),updateProgress:Object(nt.r)((function(e){var t=e.limit;return{type:"SEGUE_PROGRESS",percent:e.elapsed/t}}))},guards:{limitExceeded:function(e){var t=e.limit;return e.elapsed>=t}}}),at=Object(rt.a)({id:"video",initial:"start",context:{player:null},states:{start:{on:{"":{target:"buffering",actions:"playVideo"}}},buffering:{on:{PLAYER_PLAYING:{target:"playing"}}},playing:{on:{PAUSE:{actions:"pauseVideo"},PLAYER_PAUSED:{target:"paused"}}},paused:{on:{PLAY:{actions:"playVideo"},PLAYER_PLAYING:{target:"playing"}}}}},{actions:{playVideo:function(e){return e.player.playVideo()},pauseVideo:function(e){return e.player.pauseVideo()}}}),ct=n(24);function it(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var ut,lt=function(e){return e.docs.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?it(n,!0).forEach((function(t){Object(ct.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):it(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:e.id},e.data())}))},st=(ut={},Object(ct.a)(ut,-1,"PLAYER_LOADING"),Object(ct.a)(ut,0,"PLAYER_ENDED"),Object(ct.a)(ut,1,"PLAYER_PLAYING"),Object(ct.a)(ut,2,"PLAYER_PAUSED"),Object(ct.a)(ut,3,"PLAYER_BUFFERING"),Object(ct.a)(ut,5,"PLAYER_CUED"),ut),dt=function(){return function(e,t){var n=function(t){var n=t.data;return e(st[n])},r=function(){return e("PLAYER_ERROR")};t((function(e){var t=e.type,o=e.player;"READY"===t&&(o.addEventListener("onStateChange",n),o.addEventListener("onError",r))}))}},ft=function(e){return function(){return function(t){var n=function(e){var n=lt(e);n.length&&t(n[0].key)};return e.get().then(n),e.onSnapshot(n)}}},bt={id:"karaoke",initial:"loading",context:{songs:[],currentSong:null,player:null,segueProgress:0},states:{loading:{on:{READY:{actions:[Object(nt.b)({player:function(e,t){return t.player}}),Object(nt.h)("player")],target:"next"}}},segue:{invoke:{src:"segue",onDone:{target:"video"}},on:{PAUSE:{actions:Object(nt.h)("segue")},PLAY:{actions:Object(nt.h)("segue")},NEXT_SONG:{target:"next"},SEGUE_PROGRESS:{actions:Object(nt.b)({segueProgress:function(e,t){return t.percent}})}}},video:{invoke:{src:"video",data:{player:function(e){return e.player}}},on:{NEXT_SONG:{target:"next"},PAUSE:{actions:Object(nt.h)("video")},PLAY:{actions:Object(nt.h)("video")},PLAYER_ENDED:{target:"next"},PLAYER_ERROR:{target:"next"},PLAYER_PLAYING:{actions:Object(nt.h)("video")},PLAYER_PAUSED:{actions:Object(nt.h)("video")},PLAYER_BUFFERING:{actions:Object(nt.h)("video")}}},next:{entry:"shiftSong",on:{"":[{target:"segue",cond:function(e){return!!e.currentSong},actions:"cueVideo"},{target:"empty",actions:"clearVideo"}]}},empty:{after:{1e3:{target:"next"}}},done:{type:"final"}},invoke:[{src:"songs"},{src:"commands"},{src:"player"}],on:{UPDATE_SONGS:{actions:Object(nt.b)({songs:function(e,t){return t.songs}})},DONE:{target:"done"}}},pt=function(e,t){var n,r=e.collection("rooms/".concat(t,"/songs")),o=r.orderBy("created"),a=e.collection("rooms/".concat(t,"/commands")).orderBy("created");return Object(rt.a)(bt,{actions:{shiftSong:Object(nt.b)({currentSong:function(e){var t=e.songs.shift();return t&&t.id&&r.doc(t.id).delete(),t}}),cueVideo:function(e){var t=e.player,n=e.currentSong;t.cueVideoById(n.ytId)},clearVideo:function(e){var t=e.player;""!==t.getVideoData().title&&t.cueVideoById("")}},services:{segue:ot,video:at,songs:(n=o,function(){return function(e){var t=function(t){e({type:"UPDATE_SONGS",songs:lt(t)})};return n.get().then(t),n.onSnapshot(t)}}),player:dt,commands:ft(a)}})},mt={video:{position:"fixed",top:0,bottom:50,left:0,right:0},cover:{position:"absolute",top:0,bottom:0,left:0,right:0},screen:{position:"fixed",top:0,bottom:50,left:0,right:0,background:"#000",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#fff"},segueSinger:{fontWeight:600,fontSize:80,whiteSpace:"nowrap",paddingRight:50,paddingLeft:50,textOverflow:"ellipsis",textAlign:"center"},segueSong:{fontWeight:400,fontSize:50,padding:50,textAlign:"center"},marquee:{position:"fixed",bottom:0,left:0,right:0,height:50,display:"flex",alignItems:"center",justifyContent:"flex-start",overflow:"hidden",margin:0,padding:0,background:"#666",listStyleType:"none",whiteSpace:"nowrap",fontSize:30,fontWeight:600,color:"#fff"},marqueeItem:{marginLeft:40},progress:function(e){return{transition:"transform 1s, opacity 1s",transformOrigin:"50% 50%",transform:"scale(".concat("buffering"===e?1.5:1,")"),opacity:"buffering"===e?0:1}},controlPanel:function(e){return{position:"fixed",right:0,top:0,opacity:e?1:0,transition:"opacity 0.5s",display:"flex",alignItems:"center",justifyContent:"flex-start"}},button:{border:"none",background:"transparent",padding:0,display:"block",marginTop:10,marginRight:10,fontSize:60,cursor:"pointer",textDecoration:"none",fontFamily:"sans-serif",outline:"none"}},gt={controls:0,disablekb:1,enablejsapi:1,modestbranding:1},Ot=[{Component:M,path:"/",exact:!0},{Component:_,path:"/room/new",exact:!0},{Component:F,path:"/room/:id/join",exact:!0},{Component:xe,path:"/room/:id",exact:!0},{Component:Object(l.c)(J((function(e){var t=e.firestore,n=e.room.id,a=Object(Xe.useMachine)(pt(t,n)),c=Object(m.a)(a,3),i=c[0],u=c[1],l=c[2],s=i.value,d=i.context,f=d.currentSong,p=d.songs,g=d.segueProgress,O=l.children.get(s),j=O&&O.state.value,y=Object(r.useCallback)((function(e){var t=e.key;" "===t?"playing"===j?u("PAUSE"):"paused"===j&&u("PLAY"):"ArrowRight"===t&&u("NEXT_SONG")}),[u,j]);return Object(r.useEffect)((function(){return window.addEventListener("keydown",y),function(){window.removeEventListener("keydown",y)}}),[y]),Object(r.useEffect)((function(){return function(){u("DONE")}}),[u]),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{style:mt.video},o.a.createElement(Qe.a,{className:"youtube",containerClassName:"youtube",onReady:function(e){var t=e.target;return u({type:"READY",player:t})},opts:gt})),o.a.createElement("ol",{style:mt.marquee},p.map((function(e,t){var n=e.id,r=e.singer;return o.a.createElement("li",{key:n,style:mt.marqueeItem},0===t?"Next":t,": ",r)}))),("segue"===s||"buffering"===j)&&o.a.createElement("div",{style:mt.screen},o.a.createElement("div",{style:mt.segueSinger},f.singer),o.a.createElement("div",{style:mt.segueSong},o.a.createElement(H,null,f.title)),o.a.createElement("div",{style:mt.progress(j)},o.a.createElement(tt,{percent:g}))),"empty"===s&&o.a.createElement("div",{style:mt.screen},o.a.createElement("div",{style:mt.segueSong},"No Songs")),"loading"===s&&o.a.createElement("div",{style:mt.screen},o.a.createElement("div",{style:mt.segueSong},"Loading")),o.a.createElement("div",{onClick:function(){},onKeyDown:function(){},role:"presentation",style:mt.cover}),o.a.createElement($e,{bounceDuration:2e3},(function(e){return o.a.createElement("div",{style:mt.controlPanel(e)},"paused"===j&&o.a.createElement("button",{"aria-label":S("play"),onClick:function(){return u("PLAY")},style:mt.button,type:"button"},o.a.createElement("span",{"aria-hidden":"true"},"\u25b6\ufe0f")),"playing"===j&&o.a.createElement("button",{"aria-label":S("pause"),onClick:function(){return u("PAUSE")},style:mt.button,type:"button"},o.a.createElement("span",{"aria-hidden":"true"},"\u23f8")),o.a.createElement("button",{"aria-label":S("nextSong"),onClick:function(){return u("NEXT_SONG")},style:mt.button,type:"button"},o.a.createElement("span",{"aria-hidden":"true"},"\u23e9")),o.a.createElement(b.b,{"aria-label":S("exitRoom"),style:mt.button,title:S("exitRoom"),to:"/room/".concat(n)},o.a.createElement("span",{"aria-hidden":"true"},"\u23cf\ufe0f")))})))}))),path:"/room/:id/play",exact:!0},{Component:N,path:"/room/:id/edit",exact:!0},{Component:He,path:"/room/:id/song",exact:!1}];function jt(){var e=Object(O.a)(["\n  ","\n  color: #ddd;\n  text-decoration: none;\n  padding: 7px 15px;\n  background: #222;\n  display: block;\n"]);return jt=function(){return e},e}function yt(){var e=Object(O.a)(["\n  font-size: 14px;\n  font-weight: normal;\n  text-align: center;\n  margin: 0;\n  padding: 0;\n  display: block;\n"]);return yt=function(){return e},e}var ht=Object(g.b)(yt()),vt=Object(g.b)(jt(),I),Et=function(){return Object(g.c)("header",null,Object(g.c)("h1",{css:ht},Object(g.c)(b.b,{css:vt,to:"/"},S("appTitle"))))},xt=function(){return o.a.createElement(b.a,null,o.a.createElement(Et,null),o.a.createElement("main",{style:{background:"#000"}},o.a.createElement(p.d,null,Ot.map((function(e){var t=e.Component,n=e.path,r=e.exact;return o.a.createElement(p.b,{exact:r,key:n,path:n},o.a.createElement(t,null))})))))},St=(n(92),{apiKey:f("firebaseApiKey"),projectId:f("firebaseProjectId")});u.a.initializeApp(St),u.a.auth().signInAnonymously(),c.a.render(o.a.createElement(l.b,{firebase:u.a},o.a.createElement(xt,null)),document.getElementById("root"))}},[[61,1,2]]]);
//# sourceMappingURL=main.45a88b03.chunk.js.map